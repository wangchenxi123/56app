webpackJsonp([17],{202:function(e,t,i){function a(e){i(342)}var s=i(43)(i(288),i(372),a,null,null);e.exports=s.exports},288:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"robotUserEdit",data:function(){return{committing:!1,item:{username:"",address:"",headImageFileId:""},imgs:[],headImageUploading:!1,batchUploading:!1,formRules:{username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}]}}},created:function(){this.findUser(),this.fingHeadImgs()},methods:{findUser:function(){var e=this;this.$route.query.id&&this.$api.getRobotUser(this.$route.query.id,function(t){e.item=t.resource,e.item.headImageFileId=t.resource.head_pic},function(t){e.$message({type:"error",message:t.message})})},fingHeadImgs:function(){var e=this;this.$api.findDefaultRobotUserHeadImg({},function(t){e.imgs=t.resource},function(t){e.$notify({type:"error",message:t.message})})},headImageUploadHandle:function(e){this.uploadHandle(e,"headImageFileId")},submit:function(e){var t=this;this.$refs[e].validate(function(e){e&&!t.committing&&(t.committing=!0,t.item.id?t.$api.updateRobotUser(t.item,function(e){t.$message({type:"success",message:"修改成功"}),t.committing=!1,t.$router.go(-1)},function(e){t.$message({type:"error",message:e.message}),t.committing=!1}):t.$api.addRobotUser(t.item,function(e){t.$message({type:"success",message:"添加成功"}),t.$router.go(-1),t.committing=!1},function(e){t.$message({type:"error",message:e.message}),t.committing=!1}))})},uploadHandle:function(e,t){var i=this,a=e.file;if(!/image\/\w+/.test(a.type))return void this.$message({type:"info",message:"只能上传图片"});if(a.size>=2e6)return void this.$message({type:"warnning",message:"图片不能大于5M"});var s=new FormData;s.append("file",a),s.append("type","IMAGE"),this.headImageUploading=!0,this.$api.uploadImage(s,function(e){i.item.hasOwnProperty(t)&&(i.$set(i.item,t,e.file.id),i.imgs.push(e.file.id)),i.headImageUploading=!1},function(e){i.$message({type:"error",message:e.message}),i.headImageUploading=!1})},tempDownLoad:function(){window.location.href=this.$api.tempFile()},batchUpload:function(e){var t=this,i=e.file,a=new FormData;a.append("file",i),this.batchUploading=!0,this.$api.uploadRobotUsers(a,function(e){t.$message({type:"success",message:"上传成功"}),t.batchUploading=!1},function(e){t.$message({type:"error",message:e.message}),t.batchUploading=!1})}}}},313:function(e,t,i){t=e.exports=i(181)(!1),t.push([e.i,"",""])},342:function(e,t,i){var a=i(313);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(182)("480cc3ce",a,!0)},372:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"robotUserEdit"}},[i("h2",[e._v("编辑机器人")]),e._v(" "),i("hr"),e._v(" "),i("h4",[e._v("单个")]),e._v(" "),i("el-form",{ref:"form",attrs:{rules:e.formRules,model:e.item,"label-width":"120px"}},[i("el-form-item",{attrs:{prop:"username",label:"用户名"}},[i("el-input",{staticStyle:{width:"30%"},attrs:{size:"small",placeholder:"用户名"},model:{value:e.item.username,callback:function(t){e.item.username=t},expression:"item.username"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"address",label:"地址"}},[i("el-input",{staticStyle:{width:"30%"},attrs:{size:"small",placeholder:"地址"},model:{value:e.item.address,callback:function(t){e.item.address=t},expression:"item.address"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"headImageFileId",label:"头像"}},[i("el-upload",{staticClass:"picture-uploader",staticStyle:{width:"50px",height:"50px"},attrs:{action:"",accept:"image/*","show-file-list":!1,data:{type:"IMAGE"},disabled:e.headImageUploading,"http-request":e.headImageUploadHandle}},[e.item.headImageFileId?[i("img",{staticClass:"picture-uploader-list-item-img",attrs:{src:e.$api.file.see(e.item.headImageFileId)}})]:[i("i",{class:e.headImageUploading?"el-icon-loading":"el-icon-plus",staticStyle:{width:"50px",height:"50px",color:"#8c939d","line-height":"50px"}})]],2),e._v(" "),e._l(e.imgs,function(t,a){return i("div",{key:t.headImageFileId,staticClass:"picture-uploader-list-item",staticStyle:{width:"50px",height:"50px","margin-top":"4px"},on:{click:function(i){e.item.headImageFileId=t.headImageFileId}}},[i("img",{staticClass:"picture-uploader-list-item-img",attrs:{src:e.$api.file.see(t.headImageFileId)}})])})],2),e._v(" "),i("el-form-item",[i("el-button",{attrs:{icon:e.item.id?"edit":"plus",type:"primary",size:"small",loading:e.committing},on:{click:function(t){e.submit("form")}}},[e._v(e._s(e.item.id?"修改":"添加"))]),e._v(" "),i("el-button",{attrs:{icon:"close",type:"primary",size:"small"},on:{click:function(t){t.preventDefault(),e.$router.go(-1)}}},[e._v("取消")])],1)],1),e._v(" "),i("h4",[e._v("批量上传")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){t.preventDefault(),e.tempDownLoad(t)}}},[e._v("下载模板")]),e._v(" "),i("div",[i("div",{staticStyle:{display:"inline-block","margin-top":"4px","vertical-align":"top"}},[e._v("头像:")]),e._v(" "),e._l(e.imgs,function(t,a){return i("div",{key:t.headImageFileId,staticClass:"picture-uploader-list-item",staticStyle:{width:"50px",height:"80px",margin:"4px",cursor:"default",border:"none"}},[i("img",{staticClass:"picture-uploader-list-item-img",staticStyle:{display:"inline-block",height:"50px"},attrs:{src:e.$api.file.see(t.headImageFileId)}}),e._v(" "),i("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v(e._s(t.headImageName))])])})],2),e._v(" "),i("el-upload",{attrs:{action:"","show-file-list":!1,disabled:e.batchUploading,"http-request":e.batchUpload}},[i("el-button",{attrs:{type:"primary",size:"small",loading:e.batchUploading}},[e._v("批量上传")])],1)],1)},staticRenderFns:[]}}});