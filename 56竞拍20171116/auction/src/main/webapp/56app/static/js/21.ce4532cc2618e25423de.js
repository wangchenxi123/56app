webpackJsonp([21],{133:function(t,e,a){a(325);var i=a(6)(a(238),a(374),null,null);t.exports=i.exports},238:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"register",data:function(){return{registerData:{phone:"",sms:"",pwd:"",pwd2:"",agreement:!0},fieldState:{phone:"",sms:""},toastClient:"",codeGetting:!1,codeMessage:"获取验证码",submitting:!1}},created:function(){},activated:function(){},methods:{check:function(t){var e=this;this.validateField(t,this.registerData)&&this.$api.detection(this.registerData[t],function(a){a.result?e.fieldState[t]="success":(e.fieldState[t]="error","phone"===t&&e.toast("此手机号已存在"))},function(a){e.fieldState[t]="error",e.toast("检测失败,"+a.message)})},validateField:function(t,e){var a=!0;switch(t){case"phone":/^(((13[0-9]{1})|(14[579]{1})|(15[0-35-9]{1})|(17[0135-8]{1})|(18[0-9]{1}))+\d{8})$/.test(e.phone)||(this.toast("请输入正确手机号"),a=!1);break;case"sms":e.sms.trim()||(this.toast("请输入验证码"),a=!1);break;case"pwd":e.pwd.trim()||(this.toast("请输入登录密码"),a=!1);break;case"pwd2":e.pwd2.trim()&&e.pwd2===e.pwd||(this.toast("两次密码不一致"),a=!1);break;case"agreement":e.agreement||(this.toast("请勾选同意协议"),a=!1)}return a},sumbit:function(t){var e=this,a=!0;if("registerData"===t){for(var i in this.registerData)if(!(a=this.validateField(i,this.registerData)))return;a&&!this.submitting&&(this.submitting=!0,this.$api.registered(this.registerData,function(t){window.localStorage.setItem("expirationTime",t.resource.expirationTime),window.localStorage.setItem("token",t.resource.token),window.localStorage.setItem("identifier",t.resource.identifier),e.toast("注册成功"),e.submitting=!1,e.$router.replace({name:"userCenter"})},function(t){e.submitting=!1,e.toast("注册失败,"+t.message)}))}},toast:function(t){this.toastClient&&this.toastClient.close(),this.toastClient=this.$toast({message:t,position:"middle",duration:2e3})},getCode:function(){var t=this;if(this.registerData.phone.trim()&&!this.codeGetting&&this.validateField("phone",this.registerData)){if("error"===this.fieldState.phone)return void this.toast("此手机号已存在");if("success"!==this.fieldState.phone)return;this.codeGetting=!0,this.codeMessage=60;var e=setInterval(function(){0===t.codeMessage?(t.codeMessage="获取验证码",t.codeGetting=!1,window.clearInterval(e)):t.codeMessage--},1e3);this.$api.postCode(this.registerData.phone,function(e){t.toast("验证码发送成功")},function(a){t.codeGetting=!1,window.clearInterval(e),t.codeMessage="获取验证码",t.toast("验证码发送失败")})}}}}},291:function(t,e,a){e=t.exports=a(111)(!1),e.push([t.i,"",""])},325:function(t,e,a){var i=a(291);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(112)("25de83e0",i,!0)},374:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"register"}},[a("div",{staticClass:"page-wrap"},[a("div",{staticClass:"page-title"},[a("a",{on:{click:function(e){t.$router.replace({name:"login"})}}},[a("i",{staticClass:"icon-back"})]),t._v(" "),a("span",[t._v("新用户注册")])]),t._v(" "),a("div",{staticClass:"page-content"},[a("mt-field",{staticStyle:{"margin-top":"10px","border-top":"1px solid #ccc"},attrs:{type:"tel",label:"手机号码",placeholder:"请输入手机号码",attr:{maxLength:11},state:t.fieldState.phone},nativeOn:{"!blur":function(e){t.check("phone")}},model:{value:t.registerData.phone,callback:function(e){t.$set(t.registerData,"phone",e)},expression:"registerData.phone"}}),t._v(" "),a("mt-field",{attrs:{label:"验证号码",placeholder:"请输入验证码",attr:{maxLength:8}},model:{value:t.registerData.sms,callback:function(e){t.$set(t.registerData,"sms",e)},expression:"registerData.sms"}},[a("a",{staticStyle:{color:"#aaa"},attrs:{href:"javascript: void(0);"},on:{click:function(e){t.getCode()}}},[t._v(t._s(t.codeMessage))])]),t._v(" "),a("mt-field",{staticStyle:{"letter-spacing":"1px"},attrs:{type:"password",label:" 新 密 码",placeholder:"请输入登录密码",attr:{maxLength:20}},model:{value:t.registerData.pwd,callback:function(e){t.$set(t.registerData,"pwd",e)},expression:"registerData.pwd"}}),t._v(" "),a("mt-field",{staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{type:"password",label:"重输密码",placeholder:"请再次输入新密码",attr:{maxLength:20}},model:{value:t.registerData.pwd2,callback:function(e){t.$set(t.registerData,"pwd2",e)},expression:"registerData.pwd2"}},[t.registerData.pwd2&&t.registerData.pwd2!==t.registerData.pwd?a("span",{staticStyle:{color:"red"}},[t._v("两次密码不一致")]):t._e()]),t._v(" "),a("div",{staticStyle:{margin:"10px 0","text-align":"center","font-size":"12px"}},[a("div",{},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.registerData.agreement,expression:"registerData.agreement"}],staticStyle:{margin:"1px 0",width:"15px",height:"15px"},attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.registerData.agreement)?t._i(t.registerData.agreement,null)>-1:t.registerData.agreement},on:{change:function(e){var a=t.registerData.agreement,i=e.target,s=!!i.checked;if(Array.isArray(a)){var r=t._i(a,null);i.checked?r<0&&(t.registerData.agreement=a.concat([null])):r>-1&&(t.registerData.agreement=a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.registerData,"agreement",s)}}}),a("span",{staticStyle:{"vertical-align":"top",color:"#888"}},[t._v("注册或使用网站账号登录即视为您已同意")])]),t._v(" "),a("div",{staticStyle:{"font-size":"14px"}},[a("router-link",{attrs:{tag:"span",to:{path:"/agreement"}}},[t._v("《用户使用协议》")])],1)]),t._v(" "),a("div",{staticStyle:{padding:"0px 10px"}},[a("mt-button",{staticStyle:{width:"100%","margin-top":"20px","background-color":"red",color:"#ffffff"},attrs:{disabled:t.submitting},on:{click:function(e){t.sumbit("registerData")}}},[t._v("注册")]),t._v(" "),a("a",{staticStyle:{color:"#aaa"},attrs:{href:"javascript: void(0);"},on:{click:function(e){t.$router.replace({name:"login"})}}},[t._v("已有账号？去登录")])],1)],1)])])},staticRenderFns:[]}}});